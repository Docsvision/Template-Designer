= Справочник "{td} документов"

Модуль добавляет в систему новый конструктор -- {td} документов, доступный из {wincl}, меню "Конструкторы и справочники".

Главное окно конструктора в верхней части имеет кнопки управления правилами автозаполнения, в правой части окна расположена кнопка *Настройки*, открывающая меню основных настроек модуля.

Созданные правила автозаполнения будут отображаться в верхней половине окна. Шаблоны автозаполнения расположены в нижней части окна. Шаблоны могут быть созданы, изменены или удалены с помощью кнопок управления над списком шаблонов.

.{td} документов, Главное окно
image::designer.png[{td} документов, Главное окно]

. При первом запуске конструктора перейдите в меню *Настройки*, нажав кнопку в верхнем правом углу. Укажите необходимые настройки модуля.
+
.{td}, настройки
image::settings.png[{td}, настройки]
+
--
include::post-install.adoc[tags=settings]
--
+
. После заполнения всех полей подключение можно протестировать нажатием на кнопку *Тест*. Если подключение произошло успешно, необходимо нажать на кнопку *Сохранить*.
. Когда все базовые настройки выполнены, приступайте к созданию правил автозаполнения.
+
.Создание правил автозаполнения
image::create-rule.png[Создание правил автозаполнения]
+
* Поле _Наименование_ предназначено для указания имени правила автозаполнения. *Поле обязательно для заполнения.*
* В поле _Вид документа_ указывается вид документа, для которого будет применяться правило автозаполнения. *Поле обязательно для заполнения.*
* Поля _Конструктор справочников_ и _Справочник сотрудников_ фильтруют правила и позволяют создавать их для определенных сотрудников или строки конструктора справочников.
* В поле _Шаблоны_ при помощи кнопок справа можно изменить существующий, добавить новый или удалить шаблон. *Поле обязательно для заполнения.*
+
При добавлении шаблона необходимо выбрать файл в формате {ms} Office 2077 и выше (`.docx`), имя файла будет отображено в поле _Файлы_.
+
* В нижней части окна _Правила автозаполнения файлов_ расположены поля с тегами. Используйте кнопки над полем тегов, чтобы управлять тегами. Кнопки позволяют добавлять, редактировать и удалять поля. При нажатии кнопки *Добавить* открывается окно _Настройки замены_:
+
.Настройки замены
image::replace-settings.png[Настройки замены]
+
В окне выполняются настройки замены: что и чем заменить.
+
.Для замены представлено два варианта:
****
.. *Поле в файле* -- поле, которое можно добавить в файл Word следующим способом: menu:Вставка[Экспресс-блоки > Поле > MergeField].
.. *Строка в файле* -- любая строка в файле.

Данные, на которые можно заменить, выбираются двумя способами:

.. *На значение реквизита* -- выбор мета-данных, информация берется напрямую из метаданных.
.. *На результат выражения* -- скрипт, при помощи которого информация берется из метаданных в подходящем виде.
+
При выборе результата выражения откроется окно конструктора скриптов, в котором можно создать новый скрипт или выбрать уже заготовленный шаблон из списка. Также в этот список можно добавлять свои шаблоны, достаточно положить файл сборки в папку `Template/Template/Lib/WordExpression`.
****
+
. После добавления всех тегов в самом низу окна Конструктора шаблонов можно выбрать документ для проверки работоспособности тегов и всей информации. Для этого нужно нажать на кнопку *Выбрать документ*. После выбора документа необходимо нажать на кнопку *Сохранить и показать документы*.
